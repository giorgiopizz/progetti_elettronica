C51 COMPILER V9.59.0.0   PRINCIPALE_MISTO_ASM                                              11/04/2019 09:36:02 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE PRINCIPALE_MISTO_ASM
OBJECT MODULE PLACED IN .\Objects\principale_misto_asm.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE principale_misto_asm.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\principale_misto_asm.lst) TABS(2) OBJECT(.\Objects\principale_misto_asm.obj)

line level    source

   1          /*#include "c8051F020.h"
   2          #define CR 13
   3          #define LF 10
   4          #define ML 10
   5          #define n_loops 5
   6          //ML è Max Lenght
   7          //il programma ha 3 sezioni, divise dallo switch in scelta. Nella prima il micro trasmette un messaggio
   8          //di benvenuto, nella seconda trasmetto i caratteri ricevuto, uno alla volta, nella terza memorizza
   9          //10 caratteri(al massimo) per poi trasmetterli. Per passare da una modalità all'altra si usa il #
  10          typedef unsigned char uchar;
  11          //extern void Init_Device();
  12          extern void Start();
  13          extern void N();
  14          extern idata stack2;
  15          //idata stack[16];
  16          
  17          //dico che non mi interessa la comunicazione multiprocessore
  18          uchar key;
  19          
  20          uchar idata msg_da_trasmettere[]={'C','i','a','o',CR,LF};
  21          uchar lenght_da_trasmettere = 6;
  22          uchar idata msg_errore[]={CR,LF,'E','r','r','o','r','e',CR,LF};
  23          uchar lenght_errore=10;
  24          //uchar lenght_max = 10;
  25          
  26          uchar i=0;
  27          uchar * puntatore;
  28          uchar idata msg_ricevuto[ML+4];
  29          uchar status=0;
  30          uchar loaded=0;
  31          
  32          
  33          
  34          
  35          void scelta(void){
  36            //controllo lo status
  37            //trasmetto il messaggio di benvenuto
  38            i++;
  39            if (i<lenght_da_trasmettere){
  40              ACC=i;
  41              N();
  42              *puntatore =(uchar) ACC;
  43              SBUF0=*puntatore;
  44            }
  45            else{
  46              //vado a ricevere
  47              status++;
  48              i=0;
  49              REN0=1;
  50            }
  51              
  52          }
  53          
  54          void UARTO() interrupt 4{
C51 COMPILER V9.59.0.0   PRINCIPALE_MISTO_ASM                                              11/04/2019 09:36:02 PAGE 2   

  55          
  56            if(TI0==1){
  57              //allora ho appena finito di trasmettere
  58              scelta();
  59              loaded=0;
  60              //resettare flag
  61              TI0=0;
  62              return;
  63            }
  64            else if(RI0==1){
  65              //allora ho appena finito di ricevere
  66              scelta();
  67              return;
  68            }
  69            else{
  70              //ho un problema
  71              return;
  72            }
  73          }
  74          
  75          
  76          trasmettere benvenuto da micro, e poi aspetta in modalità eco
  77          void main(){
  78            SP=(uchar)&stack2;
  79            //Init_Device();
  80            Start();
  81            
  82            loops_on=n_loops*luminosity/100;
  83            loops=loops_on;
  84            //inizio con la trasmissione del messaggio di benvenuto
  85            ACC=i;
  86            N();
  87            *puntatore =(uchar) ACC;
  88            //puntatore =datapointer; 
  89            SBUF0=*puntatore;
  90            while(1);
  91          }*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
