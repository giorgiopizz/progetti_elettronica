C51 COMPILER V9.59.0.0   PRINCIPALE                                                        10/21/2019 10:03:57 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE PRINCIPALE
OBJECT MODULE PLACED IN .\Objects\principale.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE principale.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\principale.lst) TABS(2) OBJECT(.\Objects\principale.obj)

line level    source

   1          //principale.c
   2          #include "c8051F020.h"
   3          #define n_loops 5
   4          /*n_loops può essere decrementato per avere 
   5          una percezione migliore della luminosità. Diminuendo i loops
   6          che deve fare, aumenta la frequenza.*/
   7          
   8          
   9          char idata stack1[16];
  10          //extern char idata stack2;
  11          //extern void START(void);
  12          extern void Init_Device(void);
  13          int luminosity = 0;
  14          int loops_on;
  15          int loops; //lo stato iniziale è 1
  16          int led_status=0;
  17          int lum_status=0;//lo stato luminosity indica le opzioni(0,25, 50, 75,100)
  18          
  19          
  20          void interruzione_timer(void) interrupt 1{
  21   1        //fermo
  22   1        TR0=0;
  23   1        TF0=0;
  24   1        loops--;
  25   1        if (loops<=0){
  26   2            if(led_status){
  27   3              //accendo
  28   3              P1_6=1;
  29   3              led_status=0;
  30   3              loops=loops_on;
  31   3            }
  32   2            else{
  33   3              //spengo
  34   3              P1_6=0;
  35   3              led_status=1;
  36   3              loops=n_loops-loops_on;
  37   3              //faccio ripartire
  38   3            }
  39   2        }
  40   1        TR0=1;
  41   1      }
  42          void interruzione_pulsante(void) interrupt 19{
  43   1        TR0=0;
  44   1        TF0=0;
  45   1        //lum status  può essere 0, 1, 2,3,4
  46   1        if(lum_status<4){
  47   2          lum_status++;
  48   2        }
  49   1        else{
  50   2          lum_status=0;
  51   2        }
  52   1        luminosity=lum_status*25;
  53   1        loops_on=n_loops*luminosity/100;
  54   1        //resetto tutto
C51 COMPILER V9.59.0.0   PRINCIPALE                                                        10/21/2019 10:03:57 PAGE 2   

  55   1        loops=loops_on;
  56   1        led_status=0;
  57   1        P1_6=1;
  58   1        
  59   1        /*se volessi resettare il flag dell'interrupt esterna 7
  60   1        dovrei scrivere*/
  61   1        P3IF &= ~0x80;
  62   1        /*è necessario rimettere a 1 il flag della porta P3.7
  63   1        anche se probabilmente schiacciando il bottone verrà
  64   1        in automatico settato a 1 dopo*/
  65   1        //P3_7=0;
  66   1        //poi può rincominciare
  67   1        TR0=1;
  68   1      }
  69          void main(){
  70   1        SP = (char) (&stack1);
  71   1        //START();
  72   1        Init_Device();
  73   1        loops_on=n_loops*luminosity/100;
  74   1        loops=loops_on;//qui posso fare quello che voglio
  75   1        //P3IF &= ~0x80;
  76   1        while(1);
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    229    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10    ----
   IDATA SIZE       =     16    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
